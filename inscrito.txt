@app.route('/inscrito', methods=['POST'])
def visitante_inscrito():
    try:
        data = request.json  # Recibe los datos del webhook
        email = data['contact']['email']
        created_date = data['contact']['createdDate']

        # Datos para el archivo info_user.json
        info_user_data = {
            "first_name": data['contact']['name']['first'],
            "last_name": data['contact']['name']['last'],
            "email": email,
            "plan_name": "teste",
            "plan_start_date": created_date
        }

        # Actualiza o crea el archivo users.json
        with open(USERS_JSON, 'r+', encoding='utf-8') as file:
            users_data = json.load(file)

            if email not in users_data:  # Si el correo no existe
                user_id = str(uuid.uuid4())  # Genera un ID Ãºnico
                users_data[email] = user_id

                # Crear carpeta y archivo info_user.json
                user_folder = os.path.join(USERS_FOLDER, user_id)
                os.makedirs(user_folder, exist_ok=True)

                info_user_file = os.path.join(user_folder, 'info_user.json')
                with open(info_user_file, 'w', encoding='utf-8') as user_file:
                    json.dump(info_user_data, user_file, ensure_ascii=False, indent=4)
            else:  # Si el correo ya existe
                user_id = users_data[email]

                # Actualizar info_user.json existente
                user_folder = os.path.join(USERS_FOLDER, user_id)
                info_user_file = os.path.join(user_folder, 'info_user.json')
                with open(info_user_file, 'w', encoding='utf-8') as user_file:
                    json.dump(info_user_data, user_file, ensure_ascii=False, indent=4)

            # Guarda los cambios en users.json
            file.seek(0)
            json.dump(users_data, file, ensure_ascii=False, indent=4)
            file.truncate()

        return jsonify({'status': 'sucesso'}), 200

    except Exception as e:
        print(f"Error: {e}")
        return jsonify({'status': 'error', 'message': str(e)}), 500